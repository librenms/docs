<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="LibreNMS">
    <link rel="canonical" href="https://www.librenms.org/docs/Alerting/Templates/">
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Templates - LibreNMS Docs</title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <link href="../../librenms.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Templates", url: "#templates", children: [
              {title: "Syntax", url: "#syntax" },
              {title: "Base Templates", url: "#base-templates" },
              {title: "Examples", url: "#examples" },
              {title: "Examples HTML", url: "#examples-html" },
              {title: "Included", url: "#included" },
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-79149977-2', 'docs.librenms.org');
        ga('send', 'pageview');
    </script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
    
      <div class="source-links">
      
          <span class="label label-primary"><a href="https://github.com/librenms/librenms//edit/master/doc/Alerting/Templates.md" target="_blank" style="color:#ffffff"><i class="fa fa-pencil"></i> Edit on GitHub</a></span>
      
      </div>
    

    <h1 id="templates">Templates</h1>
<blockquote>
<p>This page is for installs running version 1.42 or later. You can find the older docs <a href="../Old_Templates/">here</a></p>
</blockquote>
<p>Templates can be assigned to a single or a group of rules and can contain any kind of text. There is also a default template which is used for any rule that isn't associated with a template. This template can be found under <code>Alert Templates</code> page and can be edited. It also has an option revert it back to its default content.</p>
<p>To attach a template to a rule just open the <code>Alert Templates</code> settings page, choose the template to assign and click the yellow button in the <code>Actions</code> column. In the appearing popupbox select the rule(s) you want the template to be assigned to and click the <code>Attach</code> button. You might hold down the CTRL key to select multiple rules at once.</p>
<p>The templating engine in use is Laravel Blade. We will cover some of the basics here, however the official Laravel docs will have more information <a href="https://laravel.com/docs/5.4/blade">here</a> </p>
<h2 id="syntax">Syntax</h2>
<p>Controls:</p>
<ul>
<li>if-else (Else can be omitted):
<code>@if ($alert-&gt;placeholder  == 'value') Some Text @else Other Text @endif</code></li>
<li>foreach-loop:
<code>@foreach ($alert-&gt;faults as $key =&gt; $value) Key: $key&lt;br/&gt;Value: $value @endforeach</code></li>
</ul>
<p>Placeholders:</p>
<p>Placeholders are special variables that if used within the template will be replaced with the relevant data, I.e:</p>
<p><code>The device {{ $alert-&gt;hostname }} has been up for {{ $alert-&gt;uptime }} seconds</code> would result in the following <code>The device localhost has been up for 30344 seconds</code>.</p>
<blockquote>
<p>When using placeholders to echo data, you need to wrap the placeholder in <code>{{ }}</code>. I.e <code>{{ $alert-&gt;hostname }}</code>.</p>
</blockquote>
<ul>
<li>Device ID: <code>$alert-&gt;device_id</code></li>
<li>Hostname of the Device: <code>$alert-&gt;hostname</code></li>
<li>sysName of the Device: <code>$alert-&gt;sysName</code></li>
<li>sysDescr of the Device: <code>$alert-&gt;sysDescr</code></li>
<li>sysContact of the Device: <code>$alert-&gt;sysContact</code></li>
<li>OS of the Device: <code>$alert-&gt;os</code></li>
<li>Type of Device: <code>$alert-&gt;type</code></li>
<li>IP of the Device: <code>$alert-&gt;ip</code></li>
<li>hardware of the Device: <code>$alert-&gt;hardware</code></li>
<li>Software version of the Device: <code>$alert-&gt;version</code> </li>
<li>location of the Device: <code>$alert-&gt;location</code></li>
<li>uptime of the Device (in seconds): <code>$alert-&gt;uptime</code></li>
<li>short uptime of the Device (28d 22h 30m 7s): <code>$alert-&gt;uptime_short</code></li>
<li>long uptime of the Device (28 days, 22h 30m 7s): <code>$alert-&gt;uptime_long</code></li>
<li>description (purpose db field) of the Device: <code>$alert-&gt;description</code></li>
<li>notes of the Device: <code>$alert-&gt;notes</code></li>
<li>notes of the alert (ack notes): <code>$alert-&gt;alert_notes</code></li>
<li>ping timestamp (if icmp enabled): <code>$alert-&gt;ping_timestamp</code></li>
<li>ping loss (if icmp enabled): <code>$alert-&gt;ping_loss</code></li>
<li>ping min (if icmp enabled): <code>$alert-&gt;ping_min</code></li>
<li>ping max (if icmp enabled): <code>$alert-&gt;ping_max</code></li>
<li>ping avg (if icmp enabled): <code>$alert-&gt;ping_avg</code></li>
<li>Title for the Alert: <code>$alert-&gt;title</code></li>
<li>Time Elapsed, Only available on recovery (<code>$alert-&gt;state == 0</code>): <code>$alert-&gt;elapsed</code></li>
<li>Rule Builder (the actual rule) (use <code>{!! $alert-&gt;builder !!}</code>): <code>$alert-&gt;builder</code></li>
<li>Alert-ID: <code>$alert-&gt;id</code></li>
<li>Unique-ID: <code>$alert-&gt;uid</code></li>
<li>Faults, Only available on alert (<code>$alert-&gt;state != 0</code>), must be iterated in a foreach (<code>@foreach ($alert-&gt;faults as $key =&gt; $value) @endforeach</code>). Holds all available information about the Fault, accessible in the format <code>$value['Column']</code>, for example: <code>$value['ifDescr']</code>. Special field <code>$value['string']</code> has most Identification-information (IDs, Names, Descrs) as single string, this is the equivalent of the default used and must be encased in <code>{{ }}</code></li>
<li>State: <code>$alert-&gt;state</code></li>
<li>Severity: <code>$alert-&gt;severity</code></li>
<li>Rule: <code>$alert-&gt;rule</code></li>
<li>Rule-Name: <code>$alert-&gt;name</code></li>
<li>Timestamp: <code>$alert-&gt;timestamp</code></li>
<li>Transport name: <code>$alert-&gt;transport</code></li>
<li>Contacts, must be iterated in a foreach, <code>$key</code> holds email and <code>$value</code> holds name: <code>$alert-&gt;contacts</code></li>
</ul>
<p>Placeholders can be used within the subjects for templates as well although $faults is most likely going to be worthless.</p>
<p>The Default Template is a 'one-size-fit-all'. We highly recommend defining your own templates for your rules to include more specific information.</p>
<h2 id="base-templates">Base Templates</h2>
<p>If you'd like to reuse a common template for your alerts follow below</p>
<p>A default file is located in
<code>resources/views/alerts/templates/default.blade.php</code>
Displays the following:</p>
<pre><code>&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;LibreNMS Alert&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div class=&quot;container&quot;&gt;
            @yield('content')
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>The important part being the <code>@yield('content')</code></p>
<p>You can use plain text or html as per Alert templates and this will form the basis of your common template, feel free to make as many templates in the directory as needed.</p>
<p>In your alert template just use</p>
<pre><code>@extends('alerts.templates.default');

@section('content')
  {{ $alert-&gt;title }}
  Severity: {{ $alert-&gt;severity }}
  ...
@endsection
</code></pre>

<p>More info: https://laravel.com/docs/5.4/blade#extending-a-layout</p>
<h2 id="examples">Examples</h2>
<p>Default Template:</p>
<pre><code class="text">{{ $alert-&gt;title }}
Severity: {{ $alert-&gt;severity }}
@if ($alert-&gt;state == 0) Time elapsed: {{ $alert-&gt;elapsed }} @endif
Timestamp: {{ $alert-&gt;timestamp }}
Unique-ID: {{ $alert-&gt;uid }}
Rule: @if ($alert-&gt;name) {{ $alert-&gt;name }} @else {{ $alert-&gt;rule }} @endif
@if ($alert-&gt;faults) Faults:
@foreach ($alert-&gt;faults as $key =&gt; $value)
  {{ $key }}: {{ $value['string'] }}
@endforeach
@endif
Alert sent to:
@foreach ($alert-&gt;contacts as $key =&gt; $value)
  {{ $value }} &lt;{{ $key }}&gt;
@endforeach
</code></pre>

<p>Ports Utilization Template:</p>
<pre><code class="text">{{ $alert-&gt;title }}
Device Name: {{ $alert-&gt;hostname }}
Severity: {{ $alert-&gt;severity }}
@if ($alert-&gt;state == 0) Time elapsed: {{ $alert-&gt;elapsed }} @endif
Timestamp: {{ $alert-&gt;timestamp }}
Rule: @if ($alert-&gt;name) {{ $alert-&gt;name }} @else {{ $alert-&gt;rule }} @endif
@foreach ($alert-&gt;faults as $key =&gt; $value)
Physical Interface: {{ $value['ifDescr'] }}
Interface Description: {{ $value['ifAlias'] }}
Interface Speed: {{ ($value['ifSpeed']/1000000000) }} Gbs
Inbound Utilization: {{ (($value['ifInOctets_rate']*8)/$value['ifSpeed'])*100 }}
Outbound Utilization: {{ (($value['ifOutOctets_rate']*8)/$value['ifSpeed'])*100 }}
@endforeach
</code></pre>

<p>Storage:</p>
<pre><code class="text">{{ $alert-&gt;title }}

Device Name: {{ $alert-&gt;hostname }}
Severity: {{ $alert-&gt;severity }} 
Uptime: {{ $alert-&gt;uptime_short }}
@if ($alert-&gt;state == 0) Time elapsed: {{ $alert-&gt;elapsed }} @endif
Timestamp: {{ $alert-&gt;timestamp }}
Location: {{ $alert-&gt;location }}
Description: {{ $alert-&gt;description }}
Features: {{ $alert-&gt;features }}
Purpose: {{ $alert-&gt;purpose }}
Notes: {{ $alert-&gt;notes }}

Server: {{ $alert-&gt;sysName }} 
@foreach ($alert-&gt;faults as $key =&gt; $value)
Mount Point: {{ $value['storage_descr'] }}
Percent Utilized: {{ $value['storage_perc'] }}
@endforeach
</code></pre>

<p>Temperature Sensors:</p>
<pre><code class="text">{{ $alert-&gt;title }}

Device Name: {{ $alert-&gt;hostname }}
Severity: {{ $alert-&gt;severity }} 
Timestamp: {{ $alert-&gt;timestamp }}
Uptime: {{ $alert-&gt;uptime_short }}
@if ($alert-&gt;state == 0) Time elapsed: {{ $alert-&gt;elapsed }} @endif
Location: {{ $alert-&gt;location }}
Description: {{ $alert-&gt;description }}
Features: {{ $alert-&gt;features }}
Purpose: {{ $alert-&gt;purpose }}
Notes: {{ $alert-&gt;notes }}

Rule: @if ($alert-&gt;name) {{ $alert-&gt;name }} @else {{ $alert-&gt;rule }} @endif
@if ($alert-&gt;faults) Faults:
@foreach ($faults as $key =&gt; $value)
#{{ $key }}: Temperature: {{ $value['sensor_current'] }} 째C
** @php echo ($value['sensor_current']-$value['sensor_limit']); @endphp째C over limit
Previous Measurement: {{ $value['sensor_prev'] }} 째C
High Temperature Limit: {{ $value['sensor_limit'] }} 째C
@endforeach
@endif
</code></pre>

<p>Value Sensors:</p>
<pre><code class="text">{{ $alert-&gt;title }}

Device Name: {{ $alert-&gt;hostname }}
Severity: {{ $alert-&gt;severity }} 
Timestamp: {{ $alert-&gt;timestamp }}
Uptime: {{ $alert-&gt;uptime_short }}
@if ($alert-&gt;state == 0) Time elapsed: {{ $alert-&gt;elapsed }} @endif
Location: {{ $alert-&gt;location }}
Description: {{ $alert-&gt;description }}
Features: {{ $alert-&gt;features }}
Purpose: {{ $alert-&gt;purpose }}
Notes: {{ $alert-&gt;notes }}

Rule: @if ($alert-&gt;name) {{ $alert-&gt;name }} @else {{ $alert-&gt;rule }} @endif
@if ($alert-&gt;faults) Faults:
@foreach ($alert-&gt;faults as $key =&gt; $value)
#{{ $key }}: Sensor {{ $value['sensor_current'] }}
** @php echo ($value['sensor_current']-$value['sensor_limit']); @endphp over limit
Previous Measurement: {{ $value['sensor_prev'] }}
Limit: {{ $value['sensor_limit'] }}
@endforeach 
@endif
</code></pre>

<p>Memory Alert:</p>
<pre><code class="text">{{ $alert-&gt;title }}

Device Name: {{ $alert-&gt;hostname }}
Severity: {{ $alert-&gt;severity }} 
Uptime: {{ $alert-&gt;uptime_short }}
@if ($alert-&gt;state == 0) Time elapsed: {{ $alert-&gt;elapsed }} @endif
Timestamp: {{ $alert-&gt;timestamp }}
Location: {{ $alert-&gt;location }}
Description: {{ $alert-&gt;description }}
Notes: {{ $alert-&gt;notes }}

Server: {{ $alert-&gt;hostname }}
@foreach ($alert-&gt;faults as $key =&gt; $value)
Memory Description: {{ $value['mempool_descr'] }} 
Percent Utilized: {{ $value['mempool_perc'] }}
@endforeach 
</code></pre>

<p>Conditional formatting example, will display a link to the host in email or just the hostname in any other transport:</p>
<pre><code class="text">@if ($alert-&gt;transport == mail)&lt;a href=&quot;https://my.librenms.install/device/device={{ $alert-&gt;hostname }}/&quot;&gt;{{ $alert-&gt;hostname }}&lt;/a&gt;
@else
{{ $alert-&gt;hostname }}
@endif
</code></pre>

<h2 id="examples-html">Examples HTML</h2>
<p>Note: To use HTML emails you must set HTML email to Yes in the WebUI under Global Settings &gt; Alerting Settings &gt; Email transport &gt; Use HTML emails</p>
<p>Note: To include Graphs you must enable unauthorized graphs in config.php. Allow_unauth_graphs_cidr is optional, but more secure.</p>
<pre><code>$config['allow_unauth_graphs_cidr'] = array('127.0.0.1/32');  
$config['allow_unauth_graphs'] = true;
</code></pre>

<p>Service Alert:</p>
<pre><code>&lt;div style=&quot;font-family:Helvetica;&quot;&gt;
&lt;h2&gt;@if ($alert-&gt;state == 1) &lt;span style=&quot;color:red;&quot;&gt;{{ $alert-&gt;severity }} @endif
@if ($alert-&gt;state == 2) &lt;span style=&quot;color:goldenrod;&quot;&gt;acknowledged @endif&lt;/span&gt;
@if ($alert-&gt;state == 3) &lt;span style=&quot;color:green;&quot;&gt;recovering @endif&lt;/span&gt;
@if ($alert-&gt;state == 0) &lt;span style=&quot;color:green;&quot;&gt;recovered @endif&lt;/span&gt;
&lt;/h2&gt;
&lt;b&gt;Host:&lt;/b&gt; {{ $alert-&gt;hostname }}&lt;br&gt;
&lt;b&gt;Duration:&lt;/b&gt; {{ $alert-&gt;elapsed }}&lt;br&gt;
&lt;br&gt;

@if ($alert-&gt;faults)
@foreach ($alert-&gt;faults as $key =&gt; $value) &lt;b&gt;{{ $value['service_desc'] }} - {{ $value['service_type'] }}&lt;/b&gt;&lt;br&gt;
{{ $value['service_message'] }}&lt;br&gt;
&lt;br&gt;
@endforeach                                                                                                              
@endif
&lt;/div&gt;
</code></pre>

<p>Processor Alert with Graph:</p>
<pre><code>{{ $alert-&gt;title }} &lt;br&gt;
Severity: {{ $alert-&gt;severity }}  &lt;br&gt;
@if ($alert-&gt;state == 0) Time elapsed: {{ $alert-&gt;elapsed }} @endif
Timestamp: {{ $alert-&gt;timestamp }} &lt;br&gt;
Alert-ID: {{ $alert-&gt;id }} &lt;br&gt;
Rule: @if ($alert-&gt;name) {{ $alert-&gt;name }} @else {{ $alert-&gt;rule }} @endif &lt;br&gt;
@if ($alert-&gt;faults) Faults:
@foreach ($alert-&gt;faults as $key =&gt; $value)
{{ $key }}: {{ $value['string'] }}&lt;br&gt;
@endforeach 
@if ($alert-&gt;faults) &lt;b&gt;Faults:&lt;/b&gt;&lt;br&gt;
@foreach ($alert-&gt;faults as $key =&gt; $value)&lt;img src=&quot;https://server/graph.php?device={{ $value['device_id'] }}&amp;type=device_processor&amp;width=459&amp;height=213&amp;lazy_w=552&amp;from=end-72h&gt;&lt;br&gt;
https://server/graphs/id={{ $value['device_id'] }}/type=device_processor/&lt;br&gt;
@endforeach 
Template: CPU alert &lt;br&gt;
@endif
@endif
</code></pre>

<h2 id="included">Included</h2>
<p>We include a few templates for you to use, these are specific to the type of alert rules you are creating. For example if you create a rule that would alert on BGP sessions then you can 
assign the BGP template to this rule to provide more information.</p>
<p>The included templates apart from the default template are:</p>
<ul>
<li>BGP Sessions</li>
<li>Ports</li>
<li>Temperature</li>
</ul>

  <br>
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="Alerting/Transports/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="Alerting/Transports/" class="btn btn-xs btn-link">
        Transports
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="Alerting/Rules/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="Alerting/Rules/" class="btn btn-xs btn-link">
        Rules
      </a>
    </div>
    
  </div>


    <br>
</div>

<footer class="col-md-12 wm-page-content">
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>